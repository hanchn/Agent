# 抖音内容自动化流程案例

## 流程概览
完整的抖音内容生成自动化流程设计

## 输入节点
- 功能：接收主题或关键词
- 示例："夏季防晒穿搭"
- 配置要点

## 热点检索节点
- 调用热点 API
- 使用 Coze 内置搜索
- 数据处理方法

## 脚本生成节点
- 调用 LLM 生成短视频脚本
- Prompt 设计技巧
- 输出格式规范

## 分镜拆解节点
- 输出镜头脚本
- 生成旁白台词
- 时间轴规划

## 输出节点
- 导出为 JSON 格式
- 导出为 Markdown 格式
- 便于后续视频制作的格式优化

## 完整流程图
[流程图和配置示例]

---------------------------

## **第七节 · 变量与模板**

### 1. 学习目标

* 理解变量（Variables）在 Coze Flow 中的作用
* 掌握在节点间传递数据的方法
* 学会使用模板（Templates）批量化生成内容
* 设计可重复使用的 Prompt 模板，提高生产效率
* 支持一次输入多条主题，实现批量内容生产

---

### 2. 课程讲解

#### 2.1 什么是变量

* **变量**是在 Flow 中存储和传递数据的容器
* 可以来源于：

  * 用户输入（Input 节点）
  * 工具调用结果（Tool 节点）
  * 知识库检索结果（KB 节点）
  * 模型生成结果（LLM 节点）
* 作用：

  * 在节点间传递信息
  * 动态拼接到 Prompt 模板中
  * 决定生成结果的定制化程度

---

#### 2.2 什么是模板

* \*\*模板（Template）\*\*是带变量占位符的文本或 Prompt
* 在运行时，变量会被实际值替换
* 作用：

  * 复用 Prompt，减少重复写作
  * 支持不同输入场景（多平台、多风格）
  * 统一输出结构

---

#### 2.3 变量命名规则

* 用小写字母 + 下划线，如 `topic`、`hot_topics`
* 变量占位符用 `{{变量名}}` 表示
* 避免使用中文变量名

---

### 3. 步骤演示

#### 目标

在“抖音脚本生成流程”中，让用户一次输入多个主题，批量生成脚本。

---

**步骤 1：修改输入节点**

1. 打开 Flow
2. 将输入字段改为：

   * 变量名：`topics`
   * 类型：数组（List of String）
   * 占位提示：`请输入多个主题，如 ["夏季防晒穿搭", "小个子显高技巧"]`

---

**步骤 2：添加循环（Loop）**

1. 在 Flow 中添加一个循环节点（For Each）
2. 循环列表：`{{topics}}`
3. 循环变量名：`topic`

---

**步骤 3：在循环中调用 KB 和 LLM**

* **KB 节点**：检索参数用 `{{topic}}`
* **Tool 节点（可选）**：传 `{{topic}}` 作为 API 查询关键词
* **LLM 节点 Prompt**：

  ```
  你是一名资深短视频编导。根据主题和品牌资料，生成抖音短视频脚本。
  主题：{{topic}}
  品牌资料：
  {{kb_results}}

  输出 JSON：
  {
    "topic": "{{topic}}",
    "title": "",
    "hook": "",
    "shots": [
      {"scene": "镜头1", "description": ""},
      {"scene": "镜头2", "description": ""}
    ],
    "hashtags": []
  }
  ```

---

**步骤 4：收集批量结果**

1. 循环结束后，将每个 `script_json` 合并到一个数组变量 `scripts_list`
2. 输出节点绑定 `{{scripts_list}}`

---

**步骤 5：测试运行**
输入：

```json
["夏季防晒穿搭", "小个子显高技巧", "旅行收纳5招"]
```

检查输出是否包含 3 条完整 JSON 脚本

---

### 4. 模板复用技巧

* **多平台模板**：一个 Prompt 模板支持不同平台，通过变量控制

  ```
  平台：{{platform}}
  ```
* **多风格模板**：在 KB 中存储不同风格的范例，生成时引用

  ```
  风格：{{style}}
  ```
* **统一输出结构**：所有模板保持一致的 JSON 格式，方便后续批处理

---

### 5. 实操案例

**案例目标**
批量生成小红书 + 抖音的新品推广文案

**流程设计**

1. 输入节点：`topics`（数组）、`platform`（枚举：抖音/小红书）
2. 循环变量：`topic`
3. KB 检索：品牌资料 + 平台风格
4. LLM 模板：

   ```
   你是一名{{platform}}文案创作者...
   ```
5. 输出数组：每条包含 `topic`、`platform`、`title`、`content`

---

### 6. 课后作业

1. 修改你的“抖音脚本生成流程”，支持一次输入多个主题
2. 添加变量 `style`（枚举值：搞笑、专业、故事化）
3. 测试输入 3 个主题 + 不同风格，记录输出变化
4. 优化 Prompt，让风格变量显著影响输出效果
