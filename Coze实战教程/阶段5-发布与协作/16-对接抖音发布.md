## **第十六节 · 私有数据与知识库安全管理**

### 1. 学习目标

* 理解私有数据与知识库在 AI 应用中的安全风险
* 掌握在 Coze 中配置知识库访问控制的方法
* 学会数据加密、脱敏、防滥用的实用手段
* 能建立多环境（开发 / 测试 / 生产）的知识库管理体系
* 制定知识库更新与审计流程

---

### 2. 课程讲解

#### 2.1 为什么要重视知识库安全

AI 应用中，知识库往往包含：

* 品牌战略文件、营销方案
* 客户资料、交易记录
* 产品研发文档、技术规格
* 运营 SOP、内部培训资料

**风险来源**：

* 开发者误用 → 将机密数据暴露给外部大模型
* API Key 泄漏 → 任何人都能调用你的私有 KB
* 员工离职 → 依旧保留访问权限
* 数据被模型“记住” → 泄漏到其他应用

---

#### 2.2 安全管理三大原则

1. **最小权限原则**：谁需要什么数据，就给什么权限
2. **环境隔离原则**：测试和生产数据彻底分开
3. **可追溯原则**：任何访问与修改都要有日志

---

### 3. 在 Coze 中的安全配置

#### 3.1 知识库权限控制

* **私有模式**（推荐）

  * 只有指定 Workspace 内的 Bot / Flow 能访问
  * 开发者需绑定权限
* **分组授权**

  * 给不同业务组创建独立 KB
  * 跨组访问需管理员审批
* **临时授权**

  * 为活动/项目开放 KB 权限，过期自动失效

---

#### 3.2 数据加密与脱敏

* **存储加密**：上传到 KB 的文件自动加密存储
* **传输加密**：HTTP 请求全程使用 HTTPS/TLS
* **字段脱敏**：

  * 手机号 → `138****5678`
  * 身份证 → `4***********1234`
* **敏感词替换**：内部代号、客户名称替换为别名

---

#### 3.3 防滥用机制

* **调用限额**：限制单日调用次数 / QPS
* **来源验证**：绑定 IP 白名单或 Token
* **数据水印**：在文档中加入隐形标识，追踪泄漏源
* **防长文本窃取**：限制单次 KB 检索最大 Token 数

---

### 4. 多环境知识库管理

| 环境       | 数据特性        | 目的             |
| -------- | ----------- | -------------- |
| **开发环境** | 模拟数据 / 脱敏数据 | 供开发调试，避免泄漏真实信息 |
| **测试环境** | 全量脱敏数据      | 测试全流程，不影响生产    |
| **生产环境** | 真实数据        | 正式业务运行，严格权限控制  |

> **建议**：用不同 KB ID 管理三套环境，避免混用。

---

### 5. 知识库更新与审计

#### 更新流程

1. 提交更新申请（包括数据来源与用途）
2. 数据脱敏处理
3. 管理员审核
4. 上传到 KB
5. 测试验证
6. 正式生效

#### 审计机制

* 定期导出访问日志（用户 / 时间 / 查询内容 / 返回结果）
* 分析异常调用（短时间高频、越权访问等）
* 违规访问 → 自动告警

---

### 6. 步骤演示（安全接入 KB）

**目标**
让“品牌短视频脚本生成”流程安全访问生产 KB

---

**步骤 1：创建私有 KB**

* 在 Coze 控制台 → 知识库 → 新建私有 KB
* 上传脱敏后的品牌资料（PDF、Markdown、CSV）

---

**步骤 2：绑定到指定 Flow**

* 只给“抖音脚本生成 Flow”授权该 KB
* 禁止其他 Bot 直接访问

---

**步骤 3：加密调用**

* 在 Flow 的 KB 检索节点中，绑定安全 Token
* 后端设置 Token 过期时间（如 24h）

---

**步骤 4：限制调用频率**

* 单用户每日调用 ≤ 50 次
* 超额 → 返回提示“请联系管理员增加配额”

---

**步骤 5：开启访问日志**

* 日志字段：

  * 调用时间
  * 调用用户
  * 检索关键词
  * 返回 Token 数
* 每周自动导出并分析

---

### 7. 高级玩法

* **动态知识库**：接入数据库或 API，按需实时加载数据，不长期存储敏感内容
* **混合 KB 检索**：先用公开 KB 提供大部分信息，再从私有 KB 获取核心差异化信息
* **隐私合规检查**：结合正则 / LLM 检查上传文档中是否含有违规数据（GDPR / CCPA）

---

### 8. 课后作业

1. 创建三套环境的 KB（开发 / 测试 / 生产）
2. 为生产 KB 设置访问权限和调用限额
3. 上传一份带敏感信息的文档，进行脱敏处理后再导入
4. 开启访问日志，并在一周后分析调用数据
5. 写一份安全策略文档，包含授权、更新、审计流程

