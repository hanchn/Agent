## **第十五节 · 用户输入与人机协作模式**

### 1. 学习目标

* 理解为什么需要人机协作而不是完全自动化
* 掌握在 Coze Flow 中插入人工交互的方式
* 能在流程中设置“等待用户确认”节点
* 学会通过飞书 / Web 界面收集用户反馈
* 让 AI 根据人工意见调整生成内容

---

### 2. 课程讲解

#### 2.1 为什么需要人机协作

即使自动化率很高，也有一些情况需要人工干预：

* **创意方向决策**：多版本文案选择最佳
* **高风险内容审核**：涉及品牌调性、敏感词判断
* **不确定性处理**：模型生成结果存在歧义
* **个性化定制**：为重要客户做差异化调整

---

#### 2.2 人机协作的常见模式

| 模式         | 说明              | 适用场景      |
| ---------- | --------------- | --------- |
| **预设选项确认** | AI 给出多个候选，用户选一个 | 标题选择、封面选择 |
| **人工补充信息** | 用户提供缺失信息        | 生成前补充数据   |
| **人工审核发布** | 人工点击“确认”才发布     | 高风险内容分发   |
| **人工修订**   | AI 输出草稿，用户修改    | 电商商品详情页   |

---

### 3. 在 Coze Flow 中实现人工交互

#### 方式一：飞书交互卡片（推荐）

* 使用 **飞书自定义机器人 Webhook** 发送带按钮的卡片
* 用户点击按钮 → 调用回调 URL → Flow 继续执行
* 适合审批、确认、选项选择

**示例卡片 JSON**：

```json
{
  "msg_type": "interactive",
  "card": {
    "config": { "wide_screen_mode": true },
    "elements": [
      { "tag": "div", "text": { "content": "AI 生成了 3 个标题候选，请选择：", "tag": "lark_md" }},
      { "tag": "action", "actions": [
        { "tag": "button", "text": { "content": "选择标题 1", "tag": "plain_text" }, "type": "primary", "value": { "choice": "1" }},
        { "tag": "button", "text": { "content": "选择标题 2", "tag": "plain_text" }, "type": "default", "value": { "choice": "2" }},
        { "tag": "button", "text": { "content": "选择标题 3", "tag": "plain_text" }, "type": "default", "value": { "choice": "3" }}
      ]}
    ]
  }
}
```

---

#### 方式二：Web 表单输入

* 在流程中生成一个唯一 URL（指向外部表单或自建页面）
* 用户填写后，结果通过 Webhook 返回 Flow
* 适合长文本补充或复杂参数配置

---

#### 方式三：暂停节点 + 人工触发

* 流程运行到关键节点暂停
* 后台界面显示“待处理任务”
* 用户点击继续 → 流程恢复执行

---

### 4. 步骤演示（标题选择）

**目标**
AI 生成 3 个短视频标题，用户选择一个作为最终发布标题。

---

**步骤 1：AI 生成候选标题**

```json
{
  "titles": ["夏日必备防晒穿搭", "小个子显高穿搭术", "旅行也能轻松防晒"]
}
```

---

**步骤 2：发送飞书交互卡片**

* 卡片包含 3 个按钮
* 用户点击按钮后，将 `choice` 发送到回调 API

---

**步骤 3：接收回调**

* 在 Coze Flow 添加 **Webhook 触发器**
* 接收 `choice` → 从 `titles` 数组中取对应项 → 存为 `final_title`

---

**步骤 4：继续执行**

* 用 `final_title` 替换生成内容中的标题字段
* 进入质检、发布等后续步骤

---

### 5. 高级玩法

* **多轮协作**：AI 提供初稿 → 用户批注 → AI 自动修改 → 用户终审
* **角色分工**：不同环节由不同角色审批（运营、法务、设计）
* **优先级处理**：紧急任务可跳过人工审核直接发布
* **反馈学习**：记录用户选择与修改，反向优化 AI Prompt

---

### 6. 实操案例

**案例目标**
构建一个“品牌短视频脚本半自动生产线”：

1. AI 生成脚本（含 3 个标题）
2. 飞书推送交互卡片 → 用户选择标题
3. 用户可在卡片中附加备注（风格建议）
4. AI 根据选择与备注调整脚本
5. 通过质检 → 自动发布到抖音

---

### 7. 课后作业

1. 在你的流程中添加“标题选择”人工交互节点
2. 使用飞书交互卡片实现用户选择
3. 将用户选择存储到数据库中
4. 测试 3 次，确保选择结果正确进入后续流程
5. 设计一个“人工修订”环节，让用户能输入修改建议

