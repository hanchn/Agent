# 项目案例 1：热点视频脚本机

## 项目目标
构建一个能够根据关键词自动生成爆款视频脚本的系统

## 输入设计
- 关键词输入接口
- 多关键词批量处理
- 关键词验证机制

## 输出设计
生成 5 条爆款脚本，包含：
- 吸引人的标题
- 详细分镜脚本
- 配乐建议
- 拍摄要点

## 技术实现
- Flow 设计思路
- 关键节点配置
- 提示词优化

## 质量保证
- 内容去重机制
- 质量评分系统
- 人工审核流程

## 部署与使用
- 系统部署步骤
- 使用操作指南
- 常见问题解决

## 效果展示
[实际生成的脚本示例]

----------------------------


## **第十七节 · 流程版本管理与回滚**

### 1. 学习目标

* 理解为什么 AI 应用需要版本管理
* 掌握在 Coze 中管理 Flow 与 Bot 的版本方法
* 能实现新版本的测试、灰度、回滚
* 学会在版本升级中保持向后兼容
* 了解如何用外部 Git 仓库辅助管理

---

### 2. 课程讲解

#### 2.1 为什么要做版本管理

* **防止新版本 Bug 影响线上业务**
* **快速回退**：出现问题可在几分钟内恢复
* **可追溯**：能清楚知道某次改动的原因与内容
* **多环境协作**：开发、测试、生产版本互不干扰

---

#### 2.2 Coze 版本机制

* **保存版本**：每次修改 Flow 后保存可生成一个版本号
* **版本标签**：给稳定版本打标签（如 v1.0、v2.1）
* **回滚版本**：一键恢复到历史版本
* **发布记录**：可查看谁在什么时候发布了什么版本

---

### 3. 版本管理策略

| 环境   | 版本规则           | 用途                      |
| ---- | -------------- | ----------------------- |
| 开发环境 | `dev-yyyymmdd` | 实验性改动，可能不稳定             |
| 测试环境 | `rc-x.x.x`     | 候选版本（release candidate） |
| 生产环境 | `vX.X.X`       | 稳定版本，供用户使用              |

---

### 4. 在 Coze 中的实操步骤

#### 步骤 1：开发新版本

1. 复制生产 Flow → 重命名为 `dev-20250812`
2. 添加或修改节点（新功能、Bug 修复）
3. 用测试数据跑通流程

---

#### 步骤 2：版本标记与保存

* 在版本管理面板中保存为新版本
* 添加备注：

  ```
  增加质检重试逻辑，修复抖音 API 超时问题
  ```

---

#### 步骤 3：灰度发布

1. 选择部分用户 / 测试账号接入新版本
2. 监控运行日志与错误率
3. 确认稳定后再切换全部流量

---

#### 步骤 4：回滚

* 如果新版本错误率 > 阈值（如 5%），立即回滚到上一个稳定版本：

  * 打开版本管理 → 选择历史版本 → “恢复到此版本”
  * 流量切回旧版本，业务不中断

---

#### 步骤 5：归档旧版本

* 保留 3\~5 个稳定版本做备份
* 超过 6 个月的历史版本可导出到外部存档

---

### 5. 与 Git 结合的高级玩法

* **导出 Flow 配置 JSON** → 存入 Git 仓库
* **版本号同步**：Git Tag 与 Coze 版本号一致
* **自动化部署**：

  * CI/CD 脚本调用 Coze API 更新指定版本
  * 回滚时直接推送旧 JSON 到 Coze

---

### 6. 最佳实践

* **小步快跑**：每次改动尽量小，方便回滚
* **双版本共存**：新版本运行在测试通道，旧版本继续生产
* **版本备注要详细**：方便回溯改动原因
* **定期清理历史版本**：减少混乱

---

### 7. 实操案例

**案例目标**
给“多平台内容分发 Flow”增加**自动字幕生成**功能，确保升级安全。

1. 复制生产 Flow → `dev-subtitle-20250812`
2. 添加字幕生成节点 → 测试通过
3. 灰度发布给运营部 3 人使用
4. 发现字幕节点在小红书 API 超时率高 → 修复并再次测试
5. 发布为 `v2.3.0`，全量切换
6. 出现抖音 API 限流 → 立刻回滚到 `v2.2.5`
7. 在 Git 中标记 `v2.3.0`，并记录问题修复计划

---

### 8. 课后作业

1. 在 Coze 中复制你现有的生产 Flow
2. 修改一个功能并保存为新版本
3. 对比两版本的运行效果
4. 模拟一次“回滚”操作
5. 将版本信息导出并存入 Git 仓库

