## 第一部分：LLM 基础概念

### 1. 封闭 vs 开源模型

| 类别       | 特点                | 代表                       | 优势              | 劣势              | 适用场景        |
| -------- | ----------------- | ------------------------ | --------------- | --------------- | ----------- |
| **封闭模型** | API 商业化提供，内部权重不开放 | GPT-4/4o、Claude、Gemini   | 高性能、更新快、支持多模态   | 成本高、可控性低、合规依赖厂商 | 快速落地高质量场景   |
| **开源模型** | 权重公开，可本地部署        | LLaMA2/3、Mistral、Qwen、Yi | 可私有化部署、可调优、成本可控 | 需要算力、更新节奏慢      | 数据敏感、定制化需求高 |

**选择思路：**

* 有合规/数据出境限制 → 优先开源（本地部署）
* 对性能和多模态要求极高 → 优先封闭
* 混合策略：核心任务用封闭，非敏感批处理用开源

---

### 2. 上下文窗口（Context Window）

* **定义**：模型一次能“记住”的最大 token 数（输入 + 输出）
* **常见范围**：

  * 4k-8k tokens（基础）
  * 32k-200k tokens（长上下文）
* **影响**：

  * 窗口越大 → 可处理的文档越长，但推理成本和延迟上升
  * 长文容易出现“注意力稀释”，导致遗忘开头信息
* **优化技巧**：

  * **分块检索（Chunking）** + **RAG（检索增强生成）**
  * 关键信息前置
  * 使用摘要压缩历史对话

---

### 3. 函数调用（Function Calling）

* **概念**：模型在对话中返回结构化 JSON，让外部系统调用工具/API
* **优势**：

  * 明确输出格式（避免幻觉）
  * 自动触发业务逻辑
* **Coze 场景示例**：

  * 订单查询 → 调用 ERP API
  * 天气问答 → 调用气象 API
* **设计要点**：

  * 函数签名明确（字段类型 + 约束）
  * 提供必要参数，防止多轮补充

---

### 4. 长文本治理

* **问题**：

  * 超长 Prompt 导致费用高、延迟高
  * 模型可能忽略早期内容
* **解决方案**：

  * 预处理：分段、提取摘要、去除噪声
  * 检索增强（RAG）
  * 结构化输入（表格/JSON）
  * 分阶段推理（先总结，再推理）

---

## 第二部分：模型能力与输出

### 1. 推理能力（Reasoning）

* **链式思考（CoT）**：引导模型按步骤推理
* **工具辅助推理**：结合计算/知识检索
* **性能差异**：封闭大模型通常在复杂推理上优于开源

### 2. 工具使用（Tool Use）

* **静态工具**：调用数据库/API
* **动态工具**：根据任务选择调用哪些工具
* **风险**：参数越权、API 调用失败，需要回退策略

### 3. 结构化输出（JSON / Schema）

* **意义**：方便程序直接解析，减少后处理成本
* **Schema 设计要点**：

  * 明确必填字段
  * 数据类型约束（string、number、enum）
  * 给出示例（Example Output）
* **验证方法**：Schema 校验器（如 `ajv`）

---

## 第三部分：实战作业

### 作业目标

对比同一任务在两款模型上的 **质量 / 延迟 / 成本** 表现，帮助学员学会模型评测方法。

**任务示例**（可替换）：

> 给出一篇 500 字的文章，要求模型生成 5 条适合抖音发布的短视频标题。

---

### 作业步骤

1. **选模型**：

   * 封闭：GPT-4o
   * 开源：Qwen-14B Chat（本地或 API）
2. **固定 Prompt**：

   ```text
   你是一名短视频运营专家，请基于以下文章生成 5 条适合抖音发布的短视频标题，要求吸引人、长度不超过 20 字：
   [文章内容...]
   ```
3. **记录指标**：

   | 模型 | 平均延迟 (s) | 成本 (¥/次) | 可用率 (%) | 吸引力评分(人工) |
   | -- | -------- | -------- | ------- | --------- |
4. **分析输出**：

   * 质量：人工打分（是否吸引人、是否符合要求）
   * 延迟：记录从请求到返回的时间
   * 成本：计算 API Token 费用或推理算力成本
5. **提交报告**：

   * 对比差异
   * 分析适用场景
   * 给出选择建议

